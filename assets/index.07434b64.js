var et=Object.defineProperty;var nt=(t,e,n)=>e in t?et(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var A=(t,e,n)=>(nt(t,typeof e!="symbol"?e+"":e,n),n);const it=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}};it();function U(t,e,n){var i=function(l){var u=[];return l.forEach(function(a){u.push(a.a,a.b)}),u}(n);let o=ot(i),r=rt(o,t,e);return lt(r,n,t,e)}function ot(t){const e=new Set;return t.filter(function(n){const i=n.x+","+n.y;return e.size!==e.add(i).size})}function rt(t,e,n){const i=[];for(let o of t){let r=Math.atan2(o.y-n,o.x-e);o.angle=r,i.push(r-1e-5,r,r+1e-5)}return i}function lt(t,e,n,i){for(var o=[],r=0;r<t.length;r++){for(var l=t[r],u=Math.cos(l),a=Math.sin(l),s={a:{x:n,y:i},b:{x:n+u,y:i+a}},f=null,p=0;p<e.length;p++){var x=at(s,e[p]);!x||(!f||x.param<f.param)&&(f=x)}!f||(f.angle=l,o.push(f))}return o=o.sort(function(g,q){return g.angle-q.angle}),o}function at(t,e){var n=t.a.x,i=t.a.y,o=t.b.x-t.a.x,r=t.b.y-t.a.y,l=e.a.x,u=e.a.y,a=e.b.x-e.a.x,s=e.b.y-e.a.y,f=Math.sqrt(o*o+r*r),p=Math.sqrt(a*a+s*s);if(o/f==a/p&&r/f==s/p)return null;var x=(o*(u-i)+r*(n-l))/(a*r-s*o),g=(l+a*x-n)/o;return g<0||x<0||x>1?null:{x:n+o*g,y:i+r*g,param:g}}const m=document.querySelector("#canvas"),c=m.getContext("2d"),k=10,N=10,st=4,ut=10,W="60px Annie Use Your Telescope";function ct(t,e,n,i,o){if(m.width=window.innerWidth,m.height=window.innerHeight,c.clearRect(0,0,m.width,m.height),t===_.MouseoverMe||t===_.ExploreMe){c.font=W,c.fillStyle="white",c.textAlign="center";let r=t===_.MouseoverMe?"Mouse over me!":"Explore me!";c.fillText(r,m.width/2,m.height/2)}if(n){const r=Math.max(m.width,m.height);xt(n,e,N,c,dt(r,n,N,c)),pt(n,e,c,ft(r,n,c)),t===_.MouseoverMe&&(c.globalCompositeOperation="source-atop",c.font=W,c.fillStyle="black",c.textAlign="center",c.fillText("Double click me!",m.width/2,m.height/2-150),c.globalCompositeOperation="source-over"),yt(n,k+1,c)}ht(i,o,c)}function V(t,e,n){e.fillStyle=n,e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length;i++){let o=t[i];e.lineTo(o.x,o.y)}e.fill()}function ft(t,e,n){let i=n.createRadialGradient(e.x,e.y,0,e.x,e.y,t);return i.addColorStop(0,"#aaa"),i.addColorStop(1,"black"),i}function dt(t,e,n,i){let o=i.createRadialGradient(e.x,e.y,0,e.x,e.y,t);return o.addColorStop(0,`rgba(255,255,255,${2/n})`),o.addColorStop(1,"rgba(255,255,255,0)"),o}function yt(t,e,n){n.fillStyle="#ffffff",n.beginPath(),n.arc(t.x,t.y,e,0,2*Math.PI,!1),n.fill()}function ht(t,e,n){n.fillStyle="#dd3838";for(let i of t){n.beginPath();let o=i!==e?st:ut;n.arc(i.x,i.y,o,0,2*Math.PI),n.fill()}}function pt(t,e,n,i){let o=U(t.x,t.y,e);V(o,n,i)}function xt(t,e,n,i,o){let r=[];for(let l=0;l<Math.PI*2;l+=Math.PI*2/n){let u=Math.cos(l)*k,a=Math.sin(l)*k;r.push(U(t.x+u,t.y+a,e))}for(let l of r)V(l,i,o)}function gt(t){let e=mt(t);return bt(e)}function mt(t){const e=[];for(var n=0;n<t.length;n++)for(var i=0;i<t.length;i++)if(n!=i){const o=Mt(t[n],t[i]);e.push(...o)}return e}function bt(t){return t.filter(function(n,i,o){return o.findIndex(function(r){return r.a.x==n.a.x&&r.a.y==n.a.y&&r.b.x==n.b.x&&r.b.y==n.b.y})==i})}function Mt(t,e){var n=t.a,i=t.b,o=e.a,r=e.b,l=vt(n,i,o,r);if(l){let u=[{a:n,b:l},{a:l,b:i},{a:o,b:l},{a:l,b:r}];for(let a=u.length-1;a>-1;a--)u[a].a.x===u[a].b.x&&u[a].a.y===u[a].b.y&&u.splice(a,1);return u}else return[t,e]}function vt(t,e,n,i){var o=t.x,r=t.y,l=e.x,u=e.y,a=n.x,s=n.y,f=i.x,p=i.y,x=(o-l)*(s-p)-(r-u)*(a-f);if(x==0)return null;var g=((o-a)*(s-p)-(r-s)*(a-f))/x,q=-((o-l)*(r-s)-(r-u)*(o-a))/x;return g>=0&&g<=1&&q>=0&&q<=1?{x:o+g*(l-o),y:r+g*(u-r)}:null}function J(t,e){let n=!1,i=t.getPoints();for(let o=0,r=i.length-1;o<i.length;r=o++){let l=i[o].x,u=i[o].y,a=i[r].x,s=i[r].y;u>e.y!=s>e.y&&e.x<(a-l)*(e.y-u)/(s-u)+l&&(n=!n)}return n}function wt(t,e,n){return!t||!e?!1:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))<n}function B(t){let e=t.getPoints(),n=0;for(let i=0;i<e.length;i++){let o=(i+1)%e.length;n+=e[i].x*e[o].y,n-=e[i].y*e[o].x}return n/=2,n}class Q{constructor(e){A(this,"points");A(this,"anchors",[]);this.points=e}getPoints(){return this.points}getPointsCoords(){return this.points.map(e=>({x:e.x,y:e.y}))}getSegments(){const e=[];for(let n=0;n<this.points.length;n++){let i=this.points[n],o=this.points[(n+1)%this.points.length];e.push({a:i,b:o})}return e}click(){this.points.forEach(e=>{this.anchors.push({x:e.x,y:e.y})})}unclick(){this.anchors=[]}move(e,n){this.anchors.length!==0&&this.points.forEach((i,o)=>{i.x=this.anchors[o].x+e,i.y=this.anchors[o].y+n})}getPoint(e,n){var i;return(i=this.points.find(o=>o.x===e&&o.y===n))!=null?i:null}}function K(t,e,n){return new Q([{x:t.x-e/2,y:t.y-n/2},{x:t.x+e/2,y:t.y-n/2},{x:t.x+e/2,y:t.y+n/2},{x:t.x-e/2,y:t.y+n/2}])}function Pt(t){const e=Math.min(window.innerWidth,window.innerHeight),n=3,i=5,o=Math.min(50,e/12),r=o*2,l=[],u=Math.floor(Math.random()*(i-n+1))+n;for(let s=0;s<u;s++){const f=Math.PI*2/u*s,p=Math.random()*(r-o+1)+o;l.push({x:Math.cos(f)*p,y:Math.sin(f)*p})}let a={x:0,y:0};for(let s=0;s<l.length;s++)a.x+=l[s].x,a.y+=l[s].y;a.x/=l.length,a.y/=l.length;for(let s=0;s<l.length;s++)l[s].x+=t.x-a.x,l[s].y+=t.y-a.y;return new Q(l)}var _=(t=>(t[t.MouseoverMe=0]="MouseoverMe",t[t.ExploreMe=1]="ExploreMe",t[t.FreePlay=2]="FreePlay",t))(_||{});const E=document.querySelector("#canvas");let C=0;var v=null;let h=null,S=null,z=!1;const _t=500,I=15,St=20;let w=!0,M=!0,L=[];const Z=t=>{for(;t.pop(););let e=window.innerWidth,n=window.innerHeight,i={x:e/2,y:n/2};t.push(K(i,e+2,n+2),K(i,e+k*4,n+k*4)),M=!0};Z(L);const b=[];let y=[],d=null,O=[];function R(t,e,n){let i=t;return i=i.concat(n),e.forEach(o=>{d||y.includes(o),i=i.concat(o.getSegments())}),i=gt(i),i}function T(){return L.map(t=>t.getSegments()).flat(1)}function kt(t){let e=F(t);e.length>1&&(e=e.sort((n,i)=>B(n)-B(i)),e=e.slice(0,1)),y=e}function F(t){return b.filter(e=>J(e,{x:t.clientX,y:t.clientY}))}let Y=R(T(),b,O),X=[];function j(){requestAnimationFrame(j),(w||M)&&(ct(C,Y,v,X,d),w=!1,M=!1)}window.onload=function(){j()};function D(t,e){return Math.max(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}function Ct(t){return!!(h&&!z&&D(h,t)<I)}function qt(t){return!!(!z&&S&&S.timeStamp&&t.timeStamp-S.timeStamp<_t&&D(S,t)<I)}function Et(t){S={x:t.clientX,y:t.clientY,timeStamp:t.timeStamp},d||kt(t),P()}E.onpointerdown=function(t){$(t);let e=!1;for(let n of X)if(wt(n,h,St)){e=!0,d=n;break}if(e||(d=null),!d){let n=!1;for(let i of y)if(J(i,{x:t.clientX,y:t.clientY})){n=!0;break}if(!n)y=[];else for(let i of y)i.click()}P(),G(t),w=!0};function zt(t){let e=!1;for(let n of F(t)){let i=b.indexOf(n),o=y.indexOf(n);i>-1&&o>-1&&(b.splice(i,1),e=!0)}if(e)y=[];else{let n=Pt({x:t.clientX,y:t.clientY});b.push(n),y=[n],C===0&&(C=1)}H(),d=null,P()}function tt(t){C===1&&F(t).length===0&&(C=2)}function G(t){t?(tt(t),v={x:t.clientX,y:t.clientY},h&&D(h,v)>I&&(z=!0)):v=null}function $(t){t?(tt(t),h={x:t.clientX,y:t.clientY,timeStamp:t.timeStamp}):h=null,z=!1}E.onpointerup=function(t){if(!d)for(let i of y)i.unclick();let e=Ct(t),n=qt(t);e&&Et(t),e&&n&&zt(t),d=null,$(null),w=!0};function P(){X=y.map(t=>t.getPoints()).flat(1),w=!0}function At(){return!v||!h?[0,0]:[v.x-(h==null?void 0:h.x),v.y-h.y]}const It=t=>{if(h&&y.length>0&&(M=!0),M){if(d){for(let e of y){let n=e.getPoint(d.x,d.y);if(n){n.x=t.clientX,n.y=t.clientY,d=n;break}}P()}else for(let e of y)M||(M=!0),e.move(...At());Y=R(T(),b,O),P()}G(t),w=!0};H();function H(){Y=R(T(),b,O)}E.onpointermove=t=>It(t);E.onmouseleave=()=>{$(null),G(null);for(let t of y)t.unclick();d=null,P()};window.onresize=()=>{Z(L),H()};window.exportPolygons=function(){let t=b.map(e=>e.getPointsCoords());console.log(t)};
